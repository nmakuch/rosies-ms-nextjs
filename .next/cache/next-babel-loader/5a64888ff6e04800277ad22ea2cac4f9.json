{"ast":null,"code":"const sgMail = require(\"@sendgrid/mail\");\n\nconst formatter = new Intl.NumberFormat(\"en-US\", {\n  style: \"currency\",\n  currency: \"USD\",\n  minimumFractionDigits: 2\n});\nexport default async function (req, res) {\n  sgMail.setApiKey(process.env.SENDGRID_API_KEY);\n  const {\n    email,\n    name,\n    phone,\n    radioValue,\n    radioLabel,\n    cleanerMessage,\n    startDate,\n    startTime,\n    optionsAddOns3,\n    labelsAddOns3,\n    pets,\n    attendance,\n    unit,\n    address,\n    buzzer,\n    materials\n  } = req.body;\n  let grandTotalArr = [];\n  let sumOptionsAddOns3 = optionsAddOns3.reduce((a, b) => a + b, 0);\n  grandTotalArr.push(sumOptionsAddOns3);\n  let reducedArr = grandTotalArr.reduce((a, b) => a + b, 0);\n  let grandTotalSumHST = formatter.format(reducedArr * 1.13 + radioLabel * 1.13);\n  const contentTo = {\n    to: \"makuch.nick@gmail.com\",\n    from: email,\n    subject: `New Message From ${name}`,\n    text: cleanerMessage,\n    html: `\n    <h1>New Booking</h1>\n        <h2>Date and time</h2>\n        <p>${startDate} at ${startTime}</p>\n        <h3>Name</h3>\n        <p>${name}</p>\n        <h3>Email</h3>\n        <p>${email}</p>\n        <h3>Phone</h3>\n        <p>${phone}</p>\n        <h3>Are there pets in the house?</h3>\n        <p>${pets}</p>\n        <h3>Will the client be home?</h3>\n        <p>${attendance}</p>\n        <h3>Address</h3>\n        <p>${address}</p>\n        <h3>Unit Number</h3>\n        <p>${unit}</p>\n        <h3>Buzzer</h3>\n        <p>${buzzer}</p>\n        <h3>Cleaner message</h3>\n        <p>${cleanerMessage}</p>\n        <h3>Do they have all the necessary tools and items?</h3>\n        <p>${materials}</p>\n\n        <h3>Selected plan:</h3>\n        <p>${radioValue}</p>\n\n        <h3>Add Ons:</h3>\n        ${labelsAddOns3[0] ? `<p>${labelsAddOns3[0]}</p>` : \"\"}\n        ${labelsAddOns3[1] ? `<p>${labelsAddOns3[1]}</p>` : \"\"}\n        ${labelsAddOns3[2] ? `<p>${labelsAddOns3[2]}</p>` : \"\"}\n        ${labelsAddOns3[3] ? `<p>${labelsAddOns3[3]}</p>` : \"\"}\n        ${labelsAddOns3[4] ? `<p>${labelsAddOns3[4]}</p>` : \"\"}\n        ${labelsAddOns3[5] ? `<p>${labelsAddOns3[5]}</p>` : \"\"}\n\n\n        <h3>Grand Total</h3>\n        <p>${grandTotalSumHST}</p>`\n  };\n  const contentFrom = {\n    to: email,\n    from: \"rosiesmaidservice@gmail.com\",\n    subject: `Rosie's Maid Service - Appointment Booking`,\n    html: `\n    <h1>Hi ${name}, thanks for booking an appointment with Rosie's Maid Service!</h1>\n    <p>We will contact you in the next 2 hours to confirm your appointment (unless we are experiencing periods of high traffic</p>\n    <br /><h2>You have selected the following date and cleaning package:</h2>\n\n        <h3>Date and time</h3>\n        <p>${startDate} at ${startTime}</p>\n\n        <h3>Selected plan:</h3>\n        <p>${radioValue}</p>\n\n        <h3>Add Ons:</h3>\n        ${labelsAddOns3[0] ? `<p>${labelsAddOns3[0]}</p>` : \"\"}\n        ${labelsAddOns3[1] ? `<p>${labelsAddOns3[1]}</p>` : \"\"}\n        ${labelsAddOns3[2] ? `<p>${labelsAddOns3[2]}</p>` : \"\"}\n        ${labelsAddOns3[3] ? `<p>${labelsAddOns3[3]}</p>` : \"\"}\n        ${labelsAddOns3[4] ? `<p>${labelsAddOns3[4]}</p>` : \"\"}\n        ${labelsAddOns3[5] ? `<p>${labelsAddOns3[5]}</p>` : \"\"}\n\n        <h3>Grand Total</h3>\n        <p>${grandTotalSumHST}</p>\n        \n        <h3>Contact us if you have any questions or concers</h3>\n        <p>(437) 777-6243</p>`\n  };\n\n  try {\n    await sgMail.send(contentTo);\n    await sgMail.send(contentFrom);\n    res.status(200).send(\"Message sent successfully.\");\n  } catch (error) {\n    console.log(\"ERROR\", error);\n    res.status(400).send(\"Message not sent.\");\n  }\n}","map":{"version":3,"sources":["/Users/nickmakuch/Documents/Code/rosies-ms-nextjs/pages/api/booking.js"],"names":["sgMail","require","formatter","Intl","NumberFormat","style","currency","minimumFractionDigits","req","res","setApiKey","process","env","SENDGRID_API_KEY","email","name","phone","radioValue","radioLabel","cleanerMessage","startDate","startTime","optionsAddOns3","labelsAddOns3","pets","attendance","unit","address","buzzer","materials","body","grandTotalArr","sumOptionsAddOns3","reduce","a","b","push","reducedArr","grandTotalSumHST","format","contentTo","to","from","subject","text","html","contentFrom","send","status","error","console","log"],"mappings":"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","sourcesContent":["const sgMail = require(\"@sendgrid/mail\");\n\nconst formatter = new Intl.NumberFormat(\"en-US\", {\n  style: \"currency\",\n  currency: \"USD\",\n  minimumFractionDigits: 2\n});\n\nexport default async function(req, res) {\n  sgMail.setApiKey(process.env.SENDGRID_API_KEY);\n\n  const {\n    email,\n    name,\n    phone,\n    radioValue,\n    radioLabel,\n    cleanerMessage,\n    startDate,\n    startTime,\n    optionsAddOns3,\n    labelsAddOns3,\n    pets,\n    attendance,\n    unit,\n    address,\n    buzzer,\n    materials\n  } = req.body;\n\n  let grandTotalArr = [];\n\n  let sumOptionsAddOns3 = optionsAddOns3.reduce((a, b) => a + b, 0);\n\n  grandTotalArr.push(sumOptionsAddOns3);\n\n  let reducedArr = grandTotalArr.reduce((a, b) => a + b, 0);\n\n  let grandTotalSumHST = formatter.format(\n    reducedArr * 1.13 + radioLabel * 1.13\n  );\n\n  const contentTo = {\n    to: \"makuch.nick@gmail.com\",\n    from: email,\n    subject: `New Message From ${name}`,\n    text: cleanerMessage,\n    html: `\n    <h1>New Booking</h1>\n        <h2>Date and time</h2>\n        <p>${startDate} at ${startTime}</p>\n        <h3>Name</h3>\n        <p>${name}</p>\n        <h3>Email</h3>\n        <p>${email}</p>\n        <h3>Phone</h3>\n        <p>${phone}</p>\n        <h3>Are there pets in the house?</h3>\n        <p>${pets}</p>\n        <h3>Will the client be home?</h3>\n        <p>${attendance}</p>\n        <h3>Address</h3>\n        <p>${address}</p>\n        <h3>Unit Number</h3>\n        <p>${unit}</p>\n        <h3>Buzzer</h3>\n        <p>${buzzer}</p>\n        <h3>Cleaner message</h3>\n        <p>${cleanerMessage}</p>\n        <h3>Do they have all the necessary tools and items?</h3>\n        <p>${materials}</p>\n\n        <h3>Selected plan:</h3>\n        <p>${radioValue}</p>\n\n        <h3>Add Ons:</h3>\n        ${labelsAddOns3[0] ? `<p>${labelsAddOns3[0]}</p>` : \"\"}\n        ${labelsAddOns3[1] ? `<p>${labelsAddOns3[1]}</p>` : \"\"}\n        ${labelsAddOns3[2] ? `<p>${labelsAddOns3[2]}</p>` : \"\"}\n        ${labelsAddOns3[3] ? `<p>${labelsAddOns3[3]}</p>` : \"\"}\n        ${labelsAddOns3[4] ? `<p>${labelsAddOns3[4]}</p>` : \"\"}\n        ${labelsAddOns3[5] ? `<p>${labelsAddOns3[5]}</p>` : \"\"}\n\n\n        <h3>Grand Total</h3>\n        <p>${grandTotalSumHST}</p>`\n  };\n\n  const contentFrom = {\n    to: email,\n    from: \"rosiesmaidservice@gmail.com\",\n    subject: `Rosie's Maid Service - Appointment Booking`,\n    html: `\n    <h1>Hi ${name}, thanks for booking an appointment with Rosie's Maid Service!</h1>\n    <p>We will contact you in the next 2 hours to confirm your appointment (unless we are experiencing periods of high traffic</p>\n    <br /><h2>You have selected the following date and cleaning package:</h2>\n\n        <h3>Date and time</h3>\n        <p>${startDate} at ${startTime}</p>\n\n        <h3>Selected plan:</h3>\n        <p>${radioValue}</p>\n\n        <h3>Add Ons:</h3>\n        ${labelsAddOns3[0] ? `<p>${labelsAddOns3[0]}</p>` : \"\"}\n        ${labelsAddOns3[1] ? `<p>${labelsAddOns3[1]}</p>` : \"\"}\n        ${labelsAddOns3[2] ? `<p>${labelsAddOns3[2]}</p>` : \"\"}\n        ${labelsAddOns3[3] ? `<p>${labelsAddOns3[3]}</p>` : \"\"}\n        ${labelsAddOns3[4] ? `<p>${labelsAddOns3[4]}</p>` : \"\"}\n        ${labelsAddOns3[5] ? `<p>${labelsAddOns3[5]}</p>` : \"\"}\n\n        <h3>Grand Total</h3>\n        <p>${grandTotalSumHST}</p>\n        \n        <h3>Contact us if you have any questions or concers</h3>\n        <p>(437) 777-6243</p>`\n  };\n\n  try {\n    await sgMail.send(contentTo);\n    await sgMail.send(contentFrom);\n    res.status(200).send(\"Message sent successfully.\");\n  } catch (error) {\n    console.log(\"ERROR\", error);\n    res.status(400).send(\"Message not sent.\");\n  }\n}\n"]},"metadata":{},"sourceType":"module"}