{"ast":null,"code":"const sgMail = require(\"@sendgrid/mail\");\n\nconst formatter = new Intl.NumberFormat(\"en-US\", {\n  style: \"currency\",\n  currency: \"USD\",\n  minimumFractionDigits: 2\n});\nexport default async function (req, res) {\n  sgMail.setApiKey(process.env.SENDGRID_API_KEY);\n  const {\n    email,\n    name,\n    phone,\n    radioValue,\n    radioLabel,\n    cleanerMessage,\n    startYear,\n    startMonth,\n    startDay,\n    startTime,\n    optionsAddOns3,\n    labelsAddOns3,\n    pets,\n    attendance,\n    unit,\n    address,\n    buzzer\n  } = req.body;\n  var month = new Array();\n  month[0] = \"January\";\n  month[1] = \"February\";\n  month[2] = \"March\";\n  month[3] = \"April\";\n  month[4] = \"May\";\n  month[5] = \"June\";\n  month[6] = \"July\";\n  month[7] = \"August\";\n  month[8] = \"September\";\n  month[9] = \"October\";\n  month[10] = \"November\";\n  month[11] = \"December\";\n  let grandTotalArr = [];\n  let sumOptionsAddOns3 = optionsAddOns3.reduce((a, b) => a + b, 0);\n  grandTotalArr.push(sumOptionsAddOns3);\n  let reducedArr = grandTotalArr.reduce((a, b) => a + b, 0);\n  let grandTotalSumHST = formatter.format(reducedArr * 1.13 + radioLabel * 1.13);\n  const contentTo = {\n    to: \"makuch.nick@gmail.com\",\n    from: email,\n    subject: `New Message From ${name}`,\n    text: cleanerMessage,\n    html: `\n    <h2>New Booking</h2>\n    <h2>Date and time</h2>\n    <p>${month[startMonth]} ${startDay}, ${startYear} at ${startTime}</p><br />\n    \n    <h2>Appointment details</h2>\n    <table>\n      <tr>\n        <th><h3>Name</h3></th>\n        <th><p>${name}</p></th>\n      </tr>\n      <tr>\n        <td><h3>Email</h3></td>\n        <td><p>${email}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Phone</h3></td>\n        <td><p>${phone}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Are there pets?</h3></td>\n        <td><p>${pets}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Will the client be home?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h3></td>\n        <td><p>${attendance}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Address</h3></td>\n        <td><p>${address}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Unit #</h3></td>\n        <td><p>${unit}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Buzzer #</h3></td>\n        <td><p>${buzzer}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Additional Notes</h3></td>\n        <td><p>${cleanerMessage}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Selected Plan</h3></td>\n        <td><p>${radioValue}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Extras</h3></td>\n        <td>\n          ${labelsAddOns3[0] ? `<p>${labelsAddOns3[0]}</p>` : \"\"}\n          ${labelsAddOns3[1] ? `<p>${labelsAddOns3[1]}</p>` : \"\"}\n          ${labelsAddOns3[2] ? `<p>${labelsAddOns3[2]}</p>` : \"\"}\n          ${labelsAddOns3[3] ? `<p>${labelsAddOns3[3]}</p>` : \"\"}\n          ${labelsAddOns3[4] ? `<p>${labelsAddOns3[4]}</p>` : \"\"}\n          ${labelsAddOns3[5] ? `<p>${labelsAddOns3[5]}</p>` : \"\"}\n        </td>\n      </tr>\n      <tr>\n        <td><h3>Grand Total</h3></td>\n        <td><p>${grandTotalSumHST}</p></td>\n      </tr>\n    </table>\n  `\n  };\n  const contentFrom = {\n    to: email,\n    from: \"rosiesmaidservice@gmail.com\",\n    subject: `Rosie's Maid Service - Appointment Booking`,\n    html: `\n    <h1>Hi ${name}, thanks for booking an appointment with Rosie's Maid Service!</h1>\n    <p>We will contact you in the next 2 hours to confirm your appointment (unless we are experiencing periods of high traffic</p>\n    <br /><h2>You have selected the following date/time and cleaning package:</h2>\n\n        <h3>Date and time</h3>\n        <p>${month[startMonth]} ${startDay}, ${startYear}  at ${startTime}</p>\n\n        <h3>Selected plan:</h3>\n        <p>${radioValue}</p>\n\n        <h3>Add Ons:</h3>\n        ${labelsAddOns3[0] ? `<p>${labelsAddOns3[0]}</p>` : \"\"}\n        ${labelsAddOns3[1] ? `<p>${labelsAddOns3[1]}</p>` : \"\"}\n        ${labelsAddOns3[2] ? `<p>${labelsAddOns3[2]}</p>` : \"\"}\n        ${labelsAddOns3[3] ? `<p>${labelsAddOns3[3]}</p>` : \"\"}\n        ${labelsAddOns3[4] ? `<p>${labelsAddOns3[4]}</p>` : \"\"}\n        ${labelsAddOns3[5] ? `<p>${labelsAddOns3[5]}</p>` : \"\"}\n\n        <h3>Grand Total</h3>\n        <p>${grandTotalSumHST}</p>\n        \n        <h3>Contact us if you have any questions or concers</h3>\n        <p>(437) 777-6243</p>`\n  };\n\n  try {\n    await sgMail.send(contentTo);\n    await sgMail.send(contentFrom);\n    res.status(200).send(\"Message sent successfully.\");\n  } catch (error) {\n    console.log(\"ERROR\", error);\n    res.status(400).send(\"Message not sent.\");\n  }\n}","map":{"version":3,"sources":["/Users/nickmakuch/Documents/Code/rosies-ms-nextjs/pages/api/booking.js"],"names":["sgMail","require","formatter","Intl","NumberFormat","style","currency","minimumFractionDigits","req","res","setApiKey","process","env","SENDGRID_API_KEY","email","name","phone","radioValue","radioLabel","cleanerMessage","startYear","startMonth","startDay","startTime","optionsAddOns3","labelsAddOns3","pets","attendance","unit","address","buzzer","body","month","Array","grandTotalArr","sumOptionsAddOns3","reduce","a","b","push","reducedArr","grandTotalSumHST","format","contentTo","to","from","subject","text","html","contentFrom","send","status","error","console","log"],"mappings":"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","sourcesContent":["const sgMail = require(\"@sendgrid/mail\");\n\nconst formatter = new Intl.NumberFormat(\"en-US\", {\n  style: \"currency\",\n  currency: \"USD\",\n  minimumFractionDigits: 2\n});\n\nexport default async function(req, res) {\n  sgMail.setApiKey(process.env.SENDGRID_API_KEY);\n\n  const {\n    email,\n    name,\n    phone,\n    radioValue,\n    radioLabel,\n    cleanerMessage,\n    startYear,\n    startMonth,\n    startDay,\n    startTime,\n    optionsAddOns3,\n    labelsAddOns3,\n    pets,\n    attendance,\n    unit,\n    address,\n    buzzer\n  } = req.body;\n\n  var month = new Array();\n  month[0] = \"January\";\n  month[1] = \"February\";\n  month[2] = \"March\";\n  month[3] = \"April\";\n  month[4] = \"May\";\n  month[5] = \"June\";\n  month[6] = \"July\";\n  month[7] = \"August\";\n  month[8] = \"September\";\n  month[9] = \"October\";\n  month[10] = \"November\";\n  month[11] = \"December\";\n\n  let grandTotalArr = [];\n\n  let sumOptionsAddOns3 = optionsAddOns3.reduce((a, b) => a + b, 0);\n\n  grandTotalArr.push(sumOptionsAddOns3);\n\n  let reducedArr = grandTotalArr.reduce((a, b) => a + b, 0);\n\n  let grandTotalSumHST = formatter.format(\n    reducedArr * 1.13 + radioLabel * 1.13\n  );\n\n  const contentTo = {\n    to: \"makuch.nick@gmail.com\",\n    from: email,\n    subject: `New Message From ${name}`,\n    text: cleanerMessage,\n    html: `\n    <h2>New Booking</h2>\n    <h2>Date and time</h2>\n    <p>${month[startMonth]} ${startDay}, ${startYear} at ${startTime}</p><br />\n    \n    <h2>Appointment details</h2>\n    <table>\n      <tr>\n        <th><h3>Name</h3></th>\n        <th><p>${name}</p></th>\n      </tr>\n      <tr>\n        <td><h3>Email</h3></td>\n        <td><p>${email}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Phone</h3></td>\n        <td><p>${phone}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Are there pets?</h3></td>\n        <td><p>${pets}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Will the client be home?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h3></td>\n        <td><p>${attendance}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Address</h3></td>\n        <td><p>${address}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Unit #</h3></td>\n        <td><p>${unit}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Buzzer #</h3></td>\n        <td><p>${buzzer}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Additional Notes</h3></td>\n        <td><p>${cleanerMessage}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Selected Plan</h3></td>\n        <td><p>${radioValue}</p></td>\n      </tr>\n      <tr>\n        <td><h3>Extras</h3></td>\n        <td>\n          ${labelsAddOns3[0] ? `<p>${labelsAddOns3[0]}</p>` : \"\"}\n          ${labelsAddOns3[1] ? `<p>${labelsAddOns3[1]}</p>` : \"\"}\n          ${labelsAddOns3[2] ? `<p>${labelsAddOns3[2]}</p>` : \"\"}\n          ${labelsAddOns3[3] ? `<p>${labelsAddOns3[3]}</p>` : \"\"}\n          ${labelsAddOns3[4] ? `<p>${labelsAddOns3[4]}</p>` : \"\"}\n          ${labelsAddOns3[5] ? `<p>${labelsAddOns3[5]}</p>` : \"\"}\n        </td>\n      </tr>\n      <tr>\n        <td><h3>Grand Total</h3></td>\n        <td><p>${grandTotalSumHST}</p></td>\n      </tr>\n    </table>\n  `\n  };\n\n  const contentFrom = {\n    to: email,\n    from: \"rosiesmaidservice@gmail.com\",\n    subject: `Rosie's Maid Service - Appointment Booking`,\n    html: `\n    <h1>Hi ${name}, thanks for booking an appointment with Rosie's Maid Service!</h1>\n    <p>We will contact you in the next 2 hours to confirm your appointment (unless we are experiencing periods of high traffic</p>\n    <br /><h2>You have selected the following date/time and cleaning package:</h2>\n\n        <h3>Date and time</h3>\n        <p>${month[startMonth]} ${startDay}, ${startYear}  at ${startTime}</p>\n\n        <h3>Selected plan:</h3>\n        <p>${radioValue}</p>\n\n        <h3>Add Ons:</h3>\n        ${labelsAddOns3[0] ? `<p>${labelsAddOns3[0]}</p>` : \"\"}\n        ${labelsAddOns3[1] ? `<p>${labelsAddOns3[1]}</p>` : \"\"}\n        ${labelsAddOns3[2] ? `<p>${labelsAddOns3[2]}</p>` : \"\"}\n        ${labelsAddOns3[3] ? `<p>${labelsAddOns3[3]}</p>` : \"\"}\n        ${labelsAddOns3[4] ? `<p>${labelsAddOns3[4]}</p>` : \"\"}\n        ${labelsAddOns3[5] ? `<p>${labelsAddOns3[5]}</p>` : \"\"}\n\n        <h3>Grand Total</h3>\n        <p>${grandTotalSumHST}</p>\n        \n        <h3>Contact us if you have any questions or concers</h3>\n        <p>(437) 777-6243</p>`\n  };\n\n  try {\n    await sgMail.send(contentTo);\n    await sgMail.send(contentFrom);\n    res.status(200).send(\"Message sent successfully.\");\n  } catch (error) {\n    console.log(\"ERROR\", error);\n    res.status(400).send(\"Message not sent.\");\n  }\n}\n"]},"metadata":{},"sourceType":"module"}