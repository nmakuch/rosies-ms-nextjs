(window.webpackJsonp=window.webpackJsonp||[]).push([["GovernanceUserPublicPointsDisplay"],{"./src/reddit/actions/governance/index.ts":function(e,t,n){"use strict";var s=n("./src/app/strings/index.ts"),r=n("./src/lib/makeActionCreator/index.ts"),o=n("./src/lib/prettyPrintNumber/index.ts"),c=n("./src/reddit/actions/modal.ts"),d=n("./src/reddit/actions/post.ts"),a=n("./src/reddit/actions/toaster.ts"),i=n("./src/config.ts"),l=n("./src/reddit/endpoints/governance/requester.ts");var u=n("./src/reddit/endpoints/governance/poll.ts");var b=n("./src/reddit/endpoints/governance/wallet.ts"),p=n("./src/reddit/models/Poll/index.ts"),m=n("./src/reddit/models/Toast/index.ts"),j=n("./src/reddit/models/Vote/index.ts"),O=n("./src/reddit/selectors/gov.ts"),f=n("./src/reddit/actions/governance/constants.ts"),g=n("./src/reddit/actions/governance/errorToast.ts");n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return v})),n.d(t,"d",(function(){return k})),n.d(t,"e",(function(){return I})),n.d(t,"h",(function(){return _})),n.d(t,"i",(function(){return G})),n.d(t,"f",(function(){return D})),n.d(t,"g",(function(){return B})),n.d(t,"j",(function(){return F})),n.d(t,"c",(function(){return q}));const x=Object(r.a)(f.b),v=Object(r.a)(f.c),y=Object(r.a)(f.d),k=Object(r.a)(f.e),I=(Object(r.a)(f.f),Object(r.a)(f.g),Object(r.a)(f.h)),h=Object(r.a)(f.i),w=Object(r.a)(f.j),N=Object(r.a)(f.k),P=Object(r.a)(f.q),_=Object(r.a)(f.r),T=Object(r.a)(f.s),E=Object(r.a)(f.t),S=Object(r.a)(f.u),U=Object(r.a)(f.v),C=Object(r.a)(f.w),G=Object(r.a)(f.x),D=(e,t)=>async(n,s,r)=>{let{apiContext:o}=r;const c=s().polls.models[e];n(w({pollId:e}));const a=await Object(u.b)(o(),c.subredditId,e,t);if(a.ok){n(N(a.body));const t=s(),r=t.polls.models[e];if(r&&Object(p.d)(r)){const{postId:e}=r,s=t.posts.models[e];s&&s.voteState===j.a.notVoted&&n(Object(d.N)(e))}}else n(h({pollId:e,error:a.error})),Object(g.a)(n,a.error)},B=(e,t)=>async(n,r,d)=>{let{apiContext:u}=d;n(T());const b=r().transfers.communityPoints.contentId||void 0,p=await function(e,t){return Object(l.a)(e,{data:{amount:t.amount,contentId:t.contentId,description:t.message,receiveUserName:t.recipient},endpoint:"".concat(i.a.metaUrl,"/wallets/me/").concat(t.subredditId,"/transfers"),method:"post"})}(u(),Object.assign({},e,{contentId:b}));if(p.ok){const d=r().user.language;n(E(Object.assign({},p.body,{subredditId:e.subredditId}))),n(Object(a.e)({kind:m.b.SuccessCommunity,text:Object(s.a)(d,"gov.transferSuccess",{amount:Object(o.a)(e.amount),recipient:e.recipient,tokenName:Object(O.m)(r(),{subredditId:e.subredditId})})})),t&&n(Object(c.f)())}else n(P({error:p.error})),Object(g.a)(n,p.error)},F=e=>async(t,n,s)=>{let{apiContext:r}=s;t(U());const o=await Object(b.a)(r(),e);o.ok?t(C(o.body)):t(S({error:o.error}))},q=(e,t)=>async(n,r,o)=>{let{apiContext:c}=o;n(y());const d=await function(e,t,n){return Object(l.a)(e,{data:{optOut:t},method:"patch",endpoint:"".concat(i.a.metaUrl,"/wallets/").concat(n,"/me")})}(c(),e,t);if(d.ok){n(C({[t]:d.body}));const o=e?"polls.optOutSuccess":"polls.optInSuccess";n(Object(a.e)({kind:m.b.SuccessCommunity,text:Object(s.a)(r().user.language,o,{tokenName:Object(O.m)(r(),{subredditId:t})})}))}else Object(g.a)(n,d.error)}},"./src/reddit/components/Governance/Token/index.tsx":function(e,t,n){"use strict";var s=n("./node_modules/react/index.js"),r=n.n(s),o=n("./node_modules/react-redux/es/index.js"),c=n("./node_modules/reselect/es/index.js"),d=n("./src/config.ts"),a=n("./src/reddit/selectors/gov.ts");const i=Object(c.c)({tokenSymbol:a.n});t.a=Object(o.b)(i)((function(e){const t=e.grey?e.tokenSymbol.grey:e.tokenSymbol.filled;return r.a.createElement("img",{className:e.className,src:"".concat(d.a.assetPath,"/").concat(t)})}))},"./src/reddit/components/Governance/UserPublicPointsDisplay/index.m.less":function(e,t,n){e.exports={token:"_3nQr7AT1U0w1HdVk-xepUB",tokenGrey:"pvn75ouWnsoKK4l_QS9yI",tokenFilled:"_3d-Rpbq-Qb88tf5D_s1rsj",amount:"_3nhTfmUMmYib8x61No0h3r",container:"_15KjTxLhBmrJE79nlBUuxb",tippable:"_2pUuGtsqXDTCxGGGGr-NXT"}},"./src/reddit/components/Governance/UserPublicPointsDisplay/index.tsx":function(e,t,n){"use strict";n.r(t);var s=n("./node_modules/react/index.js"),r=n.n(s),o=n("./node_modules/react-redux/es/index.js"),c=n("./node_modules/reselect/es/index.js"),d=n("./src/app/strings/index.ts"),a=n("./src/lib/classNames/index.ts"),i=n("./src/reddit/actions/governance/index.ts"),l=n("./src/reddit/actions/tooltip.ts"),u=n("./src/reddit/components/Governance/Token/index.tsx"),b=n("./src/reddit/components/InfoTextTooltip/index.tsx"),p=n("./src/reddit/featureFlags/index.ts"),m=n("./src/reddit/featureFlags/component.tsx"),j=n("./src/reddit/helpers/governance/tokens.ts"),O=n("./src/reddit/selectors/economics.ts"),f=n("./src/reddit/selectors/gov.ts"),g=n("./src/reddit/selectors/user.ts"),x=n("./src/reddit/components/Governance/UserPublicPointsDisplay/index.m.less"),v=n.n(x);const y=Object(c.c)({language:g.S,publicWallet:f.h,tippingEnabled:p.d.spTipping,tokenDisplayConversion:f.l,tokenName:f.m,useCrypto:f.p,userOptedOut:(e,t)=>{let{subredditId:n}=t;return Object(O.w)(e,n)}});t.default=Object(m.a)("spPublicPoints",Object(o.b)(y,e=>({onHideTooltip:()=>e(Object(l.h)()),onShowTooltip:t=>e(Object(l.f)({tooltipId:t})),onTip:(t,n,s)=>e(Object(i.h)({recipient:t,contentId:n,publicAddress:s}))}))((function(e){if(e.userOptedOut)return null;const{contentId:t,publicWallet:n,subredditId:s,tippingEnabled:o,tokenDisplayConversion:c,useCrypto:i,username:l}=e,p=n&&n.amount||void 0;if(!p)return null;const m="public-wallets-".concat(l,"-").concat(s,"-").concat(t),O=n&&n.publicAddress,f=o&&(!i||!!O);return r.a.createElement("div",{className:Object(a.a)(e.className,v.a.container,{[v.a.tippable]:f}),id:m,onClick:t=>{f&&(t.stopPropagation(),e.onTip(e.username,e.contentId,O))},onMouseEnter:()=>e.onShowTooltip(m),onMouseLeave:()=>e.onHideTooltip()},r.a.createElement(u.a,{className:v.a.tokenFilled,subredditId:e.subredditId}),r.a.createElement(u.a,{grey:!0,className:v.a.tokenGrey,subredditId:e.subredditId}),r.a.createElement("span",{className:v.a.amount},Object(j.b)(p,c)),f&&r.a.createElement(b.c,{caretOnTop:!0,tooltipId:m,text:Object(d.a)(e.language,"gov.tipText",{tokenName:e.tokenName,username:e.username})}))})))},"./src/reddit/endpoints/governance/poll.ts":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return l}));var s=n("./node_modules/lodash/get.js"),r=n.n(s),o=n("./src/config.ts"),c=n("./src/lib/omitHeaders/index.ts"),d=n("./src/reddit/constants/headers.ts"),a=(n("./src/reddit/models/Poll/index.ts"),n("./src/reddit/endpoints/governance/requester.ts"));function i(e,t,n,s){return Object(a.a)(e,{method:"put",endpoint:"".concat(o.a.metaUrl,"/polls/").concat(t,"/").concat(n,"/votes/me/").concat(s)})}function l(e,t){return Object(a.a)(Object(c.a)(e,[d.a]),{method:"get",endpoint:"".concat(e.apiUrl,"/by_id/").concat(t,".json")}).then(e=>e.ok?Object.assign({},e,{body:{title:r()(e.body,["data","children",0,"data","title"],""),url:r()(e.body,["data","children",0,"data","permalink"],"")}}):e)}},"./src/reddit/featureFlags/component.tsx":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("./node_modules/core-js/modules/es6.symbol.js");var s=n("./node_modules/react/index.js"),r=n.n(s),o=n("./node_modules/react-redux/es/index.js"),c=n("./node_modules/reselect/es/index.js"),d=n("./src/reddit/featureFlags/index.ts"),a=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(n[s[r]]=e[s[r]])}return n};function i(e,t,n){const s=Object(c.c)({featureEnabled:t=>d.d[e](t)});return Object(o.b)(s)(e=>{const{featureEnabled:s,dispatch:o}=e,c=a(e,["featureEnabled","dispatch"]);return s?r.a.createElement(t,c):void 0!==n?r.a.createElement(n,c):null})}},"./src/reddit/helpers/governance/tokens.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));n("./node_modules/core-js/modules/es6.regexp.to-string.js");var s=n("./node_modules/bignumber.js/bignumber.js"),r=n("./src/lib/prettyPrintNumber/index.ts");function o(e,t){const n=new s.BigNumber(e),r=new s.BigNumber(t);return n.dividedBy(r).decimalPlaces(2).toString()}function c(e,t){return Object(r.b)(parseInt(o(e,t),10))}}}]);
//# sourceMappingURL=GovernanceUserPublicPointsDisplay.30da0b5d3fa4c0fe36e2.js.map